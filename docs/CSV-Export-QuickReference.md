# CSV Export Format - Quick Reference

**Last Updated**: 2026-02-05  
**Purpose**: Reference for Noko CSV import format generated by this application

---

## CSV Column Structure

The application generates CSV files with the following columns in order:

| Column | Description | Example Value |
|--------|-------------|---------------|
| `Date` | Entry date (YYYY-MM-DD) | `2026-02-03` |
| `Person` | User's full name | `John Paez` |
| `Teams` | Team memberships | `Full-Time Employees, Software Engineering` |
| `Email` | User's email | `john.paez@nrgmr.com` |
| `Group/Client` | Project group/client | `CapEx Projects` |
| `Project` | Project name | `Cinesys+ (C+)` |
| `Minutes` | Time in minutes | `240` |
| `Hours` | Time in hours | `4.0` |
| `Tags` | Entry tag (no # prefix) | `development` |
| `Description` | Entry description | `Feature implementation` |
| `Billable` | Billable status | `yes` |
| `Invoiced` | Invoice status | `no` |
| `Invoice Reference` | Invoice number | _(empty)_ |
| `Paid` | Payment status | `no` |
| `Approved` | Approval status | `no` |
| `Approved By` | Approver name | _(empty)_ |

---

## Tag Values

Only the following tag values are used (no "#" prefix):

- `development` - Feature development and new implementation
- `productionsupport` - Production maintenance and bug fixes
- `QA` - Quality assurance and testing activities
- `other` - Administrative work, time-off, miscellaneous

**Important**: Time-off entries ALWAYS use the `other` tag automatically.

---

## Entry Generation Logic

### Project Entries
- **Date**: Last business day (Friday) of the week
- **Hours**: Calculated from weekly percentage × available work hours
- **Rounding**: Hours rounded to nearest 0.5
- **Adjustment**: Largest project adjusted to ensure total = available hours
- **Tags**: User-selected from dropdown
- **Description**: User-entered free text

### Time-Off Entries
- **Date**: Exact date of time off
- **Hours**: User-specified (typically 8.0 for full day)
- **Tags**: Always `other`
- **Description**: User-entered description
- **Project**: `Time-Off (OOO)`

---

## Week Registration

Time is registered on the **last business day (Friday)** of each work week, with the following rules:

1. **Week Boundary**: Monday through Sunday
2. **Work Days**: Monday through Friday only
3. **Month Filtering**: Only days within the target month count
4. **Zero-Day Weeks**: Weeks with 0 work days are excluded entirely
5. **Registration Day**: Last business day (typically Friday) of the week

### Example: February 2026

```
Week 1: Feb 2-8 (5 work days) → Register on Friday, Feb 6
Week 2: Feb 9-15 (5 work days) → Register on Friday, Feb 13
Week 3: Feb 16-22 (5 work days, minus holiday) → Register on Friday, Feb 20
Week 4: Feb 23-Mar 1 (5 work days in Feb) → Register on Friday, Feb 27
```

Note: Week starting Jan 26 is excluded because it has 0 work days in February.

---

## Hour Calculation Example

**Scenario**: Week with 40 available hours (5 days × 8 hours)
- Project A: 50% → 20.0 hours
- Project B: 30% → 12.0 hours
- Project C: 20% → 8.0 hours
- **Total**: 100% → 40.0 hours ✅

**With Time Off**: Week with 32 available hours (4 days × 8 hours, 1 holiday)
- Project A: 50% → 16.0 hours
- Project B: 50% → 16.0 hours
- **Total**: 100% → 32.0 hours ✅
- **Plus**: Separate time-off entry for 8.0 hours with `other` tag

---

## Validation Rules

✅ **Valid**:
- Percentages totaling 100% for full weeks
- Percentages < 100% when time off is present
- Each project has a tag selected
- Time-off entries have descriptions

⚠️ **Warning**:
- Percentages < 100% without time off (partial allocation)
- Empty descriptions (allowed but not recommended)

❌ **Invalid**:
- Percentages > 100% for any week
- Negative percentages
- Missing required CSV columns

---

## Import into Noko

1. Generate CSV from the application
2. Log into Noko
3. Navigate to Import section
4. Upload the generated CSV file
5. Verify entries and confirm import

**Note**: The CSV format is pre-configured to match Noko's expected column structure.

---

## Related Documentation

- [Technical Architecture](README.md#technical-architecture)
- [API Reference](README.md#api-reference)
- [Feature Details: Profile Management](feature-details/) _(when created)_
